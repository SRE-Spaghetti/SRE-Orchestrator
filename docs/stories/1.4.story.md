---
Epic: 1
Story: 4
Title: Incident Status API Endpoint
Status: Ready for Review
---

### Story

As an SRE, I want to check the status of an ongoing investigation by sending a `GET` request to `/api/v1/incidents/{id}`, so that I can monitor its progress and retrieve the results when it's complete.

### Acceptance Criteria

1.  A `GET /api/v1/incidents/{id}` endpoint is implemented, where `{id}` is the incident ID.
2.  If a valid `incident_id` is provided, the endpoint returns a `200 OK` status.
3.  The response body is a JSON object containing the `incident_id`, the original `description`, a `status` field (e.g., "pending"), and a timestamp for when it was created.
4.  If the provided `incident_id` does not exist, the endpoint returns a `404 Not Found` error.

### Dev Notes

#### API Specifications
- **Endpoint:** `GET /api/v1/incidents/{id}`
- **Path Parameter:** `id` (string, uuid)
- **Success Response:**
  - **Status Code:** 200 OK
  - **Body Schema (`Incident`):** The full incident object. [Source: `architecture/rest-api-spec.md`]
- **Error Response:**
  - **Status Code:** 404 Not Found
  - **Body Schema (`Error`):** 
    ```json
    { "code": 404, "message": "Incident not found" }
    ```
  [Source: `architecture/rest-api-spec.md`]

#### Data Models & Storage
- **Data Model (`Incident`):** The endpoint should retrieve and return an `Incident` object. [Source: `architecture/data-models.md`]
- **Storage:** The in-memory repository implemented in Story 1.3 should be extended to retrieve incidents by their ID. [Source: `architecture/high-level-architecture.md`]

#### Previous Story Insights
- Story 1.3 established the in-memory repository for storing incidents. This story will add the read functionality to that repository.

#### Testing
- **Framework:** `pytest` [Source: `architecture/test-strategy-and-standards.md`]
- **Location:** `services/orchestrator/tests/unit/` [Source: `architecture/test-strategy-and-standards.md`]
- **Coverage:** Unit tests should cover retrieving a valid incident and handling a non-existent incident (404). [Source: `architecture/test-strategy-and-standards.md`]

### Tasks / Subtasks

1.  `[x]` **(AC: 2, 3, 4)** **Update In-Memory Repository:**
    - In the repository/service class created in Story 1.3 (under `services/orchestrator/app/core/`), add a `get_by_id` method.
    - This method should take an `incident_id` as input and return the corresponding incident object from the in-memory dictionary, or `None` if it's not found.
2.  `[x]` **(AC: 1)** **Implement API Endpoint:**
    - In the incidents router (`services/orchestrator/app/api/v1/`), implement the `GET /api/v1/incidents/{id}` endpoint.
    - Use FastAPI's dependency injection to get the incident repository.
    - Call the repository's `get_by_id` method with the `id` from the path.
    - If the incident is found, return it with a `200 OK` status.
    - If the incident is `None`, raise an `HTTPException` with a `404 Not Found` status code.
3.  `[x]` **Write Unit Tests:**
    - In the test file for the incidents API (`services/orchestrator/tests/unit/`), add new tests for the `GET` endpoint.
    - Write a test to verify that a valid `incident_id` returns a `200 OK` status and the correct incident data.
    - Write a test to verify that an invalid or non-existent `incident_id` returns a `404 Not Found` status code.

### Change Log

| Date | Version | Description | Author |
| --- | --- | --- | --- |
| _TBD_ | 1.0 | Initial Draft | _TBD_ |

### Dev Agent Record

#### Agent Model Used
_TBD_

#### Debug Log References
_TBD_

#### Completion Notes List
-

#### File List
- `services/orchestrator/app/core/incident_repository.py`
- `services/orchestrator/app/api/v1/incidents.py`
- `services/orchestrator/tests/unit/test_incidents_api.py`

### QA Results

- **Status:** Not yet reviewed
- **Date:**
- **Reviewed by:**
- **Summary:**
- **Issues Found:**
- **Recommendations:**
